    - task: ArchiveFiles@2
      displayName: 'Skompresuj Całą Zawartość Target'
      inputs:
        # Pamiętaj, fetch tworzy podfolder z nazwą hosta, np. /fetched_all_target_contents/your_remote_host_name/app/target/all_target_contents/
        rootFolderOrFile: '$(System.DefaultWorkingDirectory)/fetched_all_target_contents/{{ inventory_hostname }}/app/target/all_target_contents/' # <--- DOKŁADNA ŚCIEŻKA po fetchu
        includeRootFolder: true # Czy skompresować także sam folder 'all_target_contents' wewnątrz archiwum
        archiveType: 'zip'
        archiveFile: '$(Build.ArtifactStagingDirectory)/full_target_contents_$(Build.BuildId).zip' # Nazwa nowego archiwum
        replaceExistingArchive: true
      condition: succeeded() # Uruchom, jeśli Ansible Playbook powiódł się (w tym fetch)

    - task: PublishBuildArtifacts@1
      displayName: 'Opublikuj Archiwum Pełnego Target jako Artefakt'
      inputs:
        pathToPublish: '$(Build.ArtifactStagingDirectory)/full_target_contents_$(Build.BuildId).zip' # Ścieżka do skompresowanego pliku
        artifactName: 'FullTargetContentsArchive' # <--- Nowa, unikalna nazwa artefaktu
        publishLocation: 'Container'
      condition: succeeded()
